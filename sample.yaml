encoding: 'utf-8'
enabled: true
endpoint: people
info: This endpoint is for saving and restoring people.

CREATE:
  - op: create
    query:
      databank: MySQL
      op: INSERT INTO people (name, age, hobbies) VALUES (%s, %s, %s)
      params:
      - "{{ url.name }}"
      - "{{ url.age }}"
      - "{{ url.hobbies  }}"
READ:
  import:
    json:
      test: true
      member:
        type: "str"
        contains:
        - "list"
        - "of"
        - "patterns"
        search:
        - '^list'
        - 'of'
        - 'patterns'
     url:
       page:
         type: "int"
         allow:
         - this > 0
       
  query:
    bank: MySQL
    op: SELECT * FROM people
    params:
    - "{{ uri.member }}"

  transform:
    data:
      formal: "Sir {{ this.name }}"
      lucky:
        data: "{{ this.age - 13 }}"
        type: integer
        publish: false
      expires:
        key: created
        type: datetime
        +delta:
          weeks: 2
      timestamp:
        key: created
        type: string
    group:
      keys:
      - name
      data:
        name: "{{ group.max('created', name) }}"
        man years:
          data: "{{ group.sum('age') }}"
          type: integer
        average:
          data: "{{ group.avg('age') }}"
          type: number
    order:
    - { key: 'name', order: 'asc' }
    - { key: 'age' order: 'desc' }
    paginate:
      limit: "{{ url.limit }}"
      page: "{{ url.page }}"


UPDATE:
  - op: update

DELETE:
  - op: delete
